# 20231125
## 1023
- cannot locate where to define num_classes
- define number of output classes: get_unet()
## 0018
```bash
(brats2023) tom@b760:~/Documents/y4_t1/fyp/3DUNet-BraTS-PyTorch$ python train_brats2021.py --dataset brats2023 --data_root ../brats2023/ --cases_split ./data/split/brats2023_split_fold0.csv --epochs 3 --eval_freq 1 --save_model --save_pred --exp_dir ./saved_model/
20231127 00:16:58 INFO: -------------------- New Experiment --------------------
20231127 00:16:58 INFO: train_brats2021.py --dataset brats2023 --data_root ../brats2023/ --cases_split ./data/split/brats2023_split_fold0.csv --epochs 3 --eval_freq 1 --save_model --save_pred --exp_dir ./saved_model/
20231127 00:16:58 INFO: Namespace(amp=False, batch_size=2, beta1=0.9, beta2=0.999, block='plain', cases_split='./data/split/brats2023_split_fold0.csv', channels_list=[32, 64, 128, 256, 320, 320], clip_grad=False, comment='', data_parallel=False, data_root='../brats2023/', dataset='brats2023', deep_supervision=False, dropout_prob=0.0, ds_layer=4, epochs=3, eval_freq=1, exp_dir='./saved_model/_brats2023_unet_adamw_none_pos1.0_neg1.0_1127_001658', gpus=None, infer_batch_size=4, input_channels=4, kernel_size=3, lr=0.001, lr_gamma=0.1, milestones=[60, 80], neg_ratio=1.0, norm='instance', num_classes=3, num_workers=6, optim='adamw', patch_overlap=0.5, patch_size=128, pos_ratio=1.0, print_freq=5, save_freq=10, save_model=True, save_pred=True, scheduler='none', seed=1000, sliding_window_mode='constant', sw_batch_size=2, unet_arch='unet', warmup_epochs=5, weight_decay=0.0001, weight_path=None)
20231127 00:16:59 INFO: ==> Training starts...
20231127 00:17:23 INFO: Train: [0][1/2] Time 24.396 (24.396)    Data  4.064 ( 4.064)    BCE 0.7389 (0.7389)     Dice 0.9475 (0.9475) Loss 1.6864 (1.6864)
20231127 00:17:33 INFO: ==> Validation starts...
20231127 00:17:41 INFO: Val: [0][1/1]   Time  7.306 ( 7.306)    Dice_WT 0.175 (0.175)   Dice_TC 0.461 (0.461)   Dice_ET 0.307 (0.307)HD95_WT  76.407 ( 76.407)        HD95_TC 109.952 (109.952)       HD95_ET 127.664 (127.664)
20231127 00:17:41 INFO: ==> Validation ends...
20231127 00:17:46 INFO: Train: [1][1/2] Time  5.146 ( 5.146)    Data  4.463 ( 4.463)    BCE 0.6960 (0.6960)     Dice 0.9403 (0.9403) Loss 1.6363 (1.6363)
20231127 00:17:46 INFO: ==> Validation starts...
20231127 00:17:53 INFO: Val: [1][1/1]   Time  7.257 ( 7.257)    Dice_WT 0.460 (0.460)   Dice_TC 0.411 (0.411)   Dice_ET 0.277 (0.277)HD95_WT 131.229 (131.229)        HD95_TC  92.984 ( 92.984)       HD95_ET 131.164 (131.164)
20231127 00:17:54 INFO: ==> Validation ends...
20231127 00:17:58 INFO: Train: [2][1/2] Time  4.638 ( 4.638)    Data  3.938 ( 3.938)    BCE 0.6710 (0.6710)     Dice 0.9354 (0.9354) Loss 1.6065 (1.6065)
20231127 00:17:59 INFO: ==> Validation starts...
20231127 00:18:06 INFO: Val: [2][1/1]   Time  7.140 ( 7.140)    Dice_WT 0.472 (0.472)   Dice_TC 0.491 (0.491)   Dice_ET 0.405 (0.405)HD95_WT  83.091 ( 83.091)        HD95_TC  81.985 ( 81.985)       HD95_ET  89.031 ( 89.031)
20231127 00:18:06 INFO: ==> Validation ends...
20231127 00:18:06 INFO: ==> Testing starts...
20231127 00:18:13 INFO: Test: [2][1/1]  Time  7.701 ( 7.701)    Dice_WT 0.496 (0.496)   Dice_TC 0.522 (0.522)   Dice_ET 0.447 (0.447)HD95_WT  73.110 ( 73.110)        HD95_TC  71.540 ( 71.540)       HD95_ET  77.004 ( 77.004)
20231127 00:18:13 INFO: ==> Saving...
20231127 00:18:14 INFO: ==> Testing ends...
```
